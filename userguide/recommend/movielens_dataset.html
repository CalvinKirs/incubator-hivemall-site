
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Data preparation Â· Hivemall User Manual</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-splitter/splitter.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-etoc/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-callouts/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-codeblock-filename/block.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-multipart/multipart.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-emphasize/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="movielens_mf.html" />
    
    
    <link rel="prev" href="movielens.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://hivemall.incubator.apache.org/" target="_blank" class="custom-link"><i class="fa fa-home"></i> Home</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        <li class="header">TABLE OF CONTENTS</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../getting_started/">
            
                <a href="../getting_started/">
            
                    
                        <b>1.2.</b>
                    
                    Getting Started
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../getting_started/installation.html">
            
                <a href="../getting_started/installation.html">
            
                    
                        <b>1.2.1.</b>
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../getting_started/permanent-functions.html">
            
                <a href="../getting_started/permanent-functions.html">
            
                    
                        <b>1.2.2.</b>
                    
                    Install as permanent functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../getting_started/input-format.html">
            
                <a href="../getting_started/input-format.html">
            
                    
                        <b>1.2.3.</b>
                    
                    Input Format
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../tips/">
            
                <a href="../tips/">
            
                    
                        <b>1.3.</b>
                    
                    Tips for Effective Hivemall
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../tips/addbias.html">
            
                <a href="../tips/addbias.html">
            
                    
                        <b>1.3.1.</b>
                    
                    Explicit addBias() for better prediction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../tips/rand_amplify.html">
            
                <a href="../tips/rand_amplify.html">
            
                    
                        <b>1.3.2.</b>
                    
                    Use rand_amplify() to better prediction results
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../tips/rt_prediction.html">
            
                <a href="../tips/rt_prediction.html">
            
                    
                        <b>1.3.3.</b>
                    
                    Real-time Prediction on RDBMS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../tips/ensemble_learning.html">
            
                <a href="../tips/ensemble_learning.html">
            
                    
                        <b>1.3.4.</b>
                    
                    Ensemble learning for stable prediction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../tips/mixserver.html">
            
                <a href="../tips/mixserver.html">
            
                    
                        <b>1.3.5.</b>
                    
                    Mixing models for a better prediction convergence (MIX server)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="../tips/emr.html">
            
                <a href="../tips/emr.html">
            
                    
                        <b>1.3.6.</b>
                    
                    Run Hivemall on Amazon Elastic MapReduce
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../tips/general_tips.html">
            
                <a href="../tips/general_tips.html">
            
                    
                        <b>1.4.</b>
                    
                    General Hive/Hadoop tips
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../tips/rowid.html">
            
                <a href="../tips/rowid.html">
            
                    
                        <b>1.4.1.</b>
                    
                    Adding rowid for each row
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../tips/hadoop_tuning.html">
            
                <a href="../tips/hadoop_tuning.html">
            
                    
                        <b>1.4.2.</b>
                    
                    Hadoop tuning for Hivemall
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../troubleshooting/">
            
                <a href="../troubleshooting/">
            
                    
                        <b>1.5.</b>
                    
                    Troubleshooting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../troubleshooting/oom.html">
            
                <a href="../troubleshooting/oom.html">
            
                    
                        <b>1.5.1.</b>
                    
                    OutOfMemoryError in training
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../troubleshooting/mapjoin_task_error.html">
            
                <a href="../troubleshooting/mapjoin_task_error.html">
            
                    
                        <b>1.5.2.</b>
                    
                    SemanticException Generate Map Join Task Error: Cannot serialize object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../troubleshooting/asterisk.html">
            
                <a href="../troubleshooting/asterisk.html">
            
                    
                        <b>1.5.3.</b>
                    
                    Asterisk argument for UDTF does not work
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../troubleshooting/num_mappers.html">
            
                <a href="../troubleshooting/num_mappers.html">
            
                    
                        <b>1.5.4.</b>
                    
                    The number of mappers is less than input splits in Hadoop 2.x
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../troubleshooting/mapjoin_classcastex.html">
            
                <a href="../troubleshooting/mapjoin_classcastex.html">
            
                    
                        <b>1.5.5.</b>
                    
                    Map-side Join causes ClassCastException on Tez
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part II - Generic Features</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../misc/generic_funcs.html">
            
                <a href="../misc/generic_funcs.html">
            
                    
                        <b>2.1.</b>
                    
                    List of generic Hivemall functions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../misc/topk.html">
            
                <a href="../misc/topk.html">
            
                    
                        <b>2.2.</b>
                    
                    Efficient Top-K query processing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../misc/tokenizer.html">
            
                <a href="../misc/tokenizer.html">
            
                    
                        <b>2.3.</b>
                    
                    English/Japanese Text Tokenizer
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part III - Feature Engineering</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../ft_engineering/scaling.html">
            
                <a href="../ft_engineering/scaling.html">
            
                    
                        <b>3.1.</b>
                    
                    Feature Scaling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../ft_engineering/hashing.html">
            
                <a href="../ft_engineering/hashing.html">
            
                    
                        <b>3.2.</b>
                    
                    Feature Hashing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../ft_engineering/tfidf.html">
            
                <a href="../ft_engineering/tfidf.html">
            
                    
                        <b>3.3.</b>
                    
                    TF-IDF calculation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../ft_engineering/ft_trans.html">
            
                <a href="../ft_engineering/ft_trans.html">
            
                    
                        <b>3.4.</b>
                    
                    FEATURE TRANSFORMATION
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="../ft_engineering/vectorizer.html">
            
                <a href="../ft_engineering/vectorizer.html">
            
                    
                        <b>3.4.1.</b>
                    
                    Vectorize Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="../ft_engineering/quantify.html">
            
                <a href="../ft_engineering/quantify.html">
            
                    
                        <b>3.4.2.</b>
                    
                    Quantify non-number features
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part IV - Evaluation</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../eval/stat_eval.html">
            
                <a href="../eval/stat_eval.html">
            
                    
                        <b>4.1.</b>
                    
                    Statistical evaluation of a prediction model
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../eval/datagen.html">
            
                <a href="../eval/datagen.html">
            
                    
                        <b>4.2.</b>
                    
                    Data Generation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="../eval/lr_datagen.html">
            
                <a href="../eval/lr_datagen.html">
            
                    
                        <b>4.2.1.</b>
                    
                    Logistic Regression data generation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part V - Binary classification</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../binaryclass/a9a.html">
            
                <a href="../binaryclass/a9a.html">
            
                    
                        <b>5.1.</b>
                    
                    a9a Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="../binaryclass/a9a_dataset.html">
            
                <a href="../binaryclass/a9a_dataset.html">
            
                    
                        <b>5.1.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="../binaryclass/a9a_lr.html">
            
                <a href="../binaryclass/a9a_lr.html">
            
                    
                        <b>5.1.2.</b>
                    
                    Logistic Regression
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.3" data-path="../binaryclass/a9a_minibatch.html">
            
                <a href="../binaryclass/a9a_minibatch.html">
            
                    
                        <b>5.1.3.</b>
                    
                    Mini-batch Gradient Descent
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../binaryclass/news20.html">
            
                <a href="../binaryclass/news20.html">
            
                    
                        <b>5.2.</b>
                    
                    News20 Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../binaryclass/news20_dataset.html">
            
                <a href="../binaryclass/news20_dataset.html">
            
                    
                        <b>5.2.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../binaryclass/news20_pa.html">
            
                <a href="../binaryclass/news20_pa.html">
            
                    
                        <b>5.2.2.</b>
                    
                    Perceptron, Passive Aggressive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.3" data-path="../binaryclass/news20_scw.html">
            
                <a href="../binaryclass/news20_scw.html">
            
                    
                        <b>5.2.3.</b>
                    
                    CW, AROW, SCW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.4" data-path="../binaryclass/news20_adagrad.html">
            
                <a href="../binaryclass/news20_adagrad.html">
            
                    
                        <b>5.2.4.</b>
                    
                    AdaGradRDA, AdaGrad, AdaDelta
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../binaryclass/kdd2010a.html">
            
                <a href="../binaryclass/kdd2010a.html">
            
                    
                        <b>5.3.</b>
                    
                    KDD2010a Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../binaryclass/kdd2010a_dataset.html">
            
                <a href="../binaryclass/kdd2010a_dataset.html">
            
                    
                        <b>5.3.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.2" data-path="../binaryclass/kdd2010a_scw.html">
            
                <a href="../binaryclass/kdd2010a_scw.html">
            
                    
                        <b>5.3.2.</b>
                    
                    PA, CW, AROW, SCW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="../binaryclass/kdd2010b.html">
            
                <a href="../binaryclass/kdd2010b.html">
            
                    
                        <b>5.4.</b>
                    
                    KDD2010b Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.4.1" data-path="../binaryclass/kdd2010b_dataset.html">
            
                <a href="../binaryclass/kdd2010b_dataset.html">
            
                    
                        <b>5.4.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.4.2" data-path="../binaryclass/kdd2010b_arow.html">
            
                <a href="../binaryclass/kdd2010b_arow.html">
            
                    
                        <b>5.4.2.</b>
                    
                    AROW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="../binaryclass/webspam.html">
            
                <a href="../binaryclass/webspam.html">
            
                    
                        <b>5.5.</b>
                    
                    Webspam Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.5.1" data-path="../binaryclass/webspam_dataset.html">
            
                <a href="../binaryclass/webspam_dataset.html">
            
                    
                        <b>5.5.1.</b>
                    
                    Data pareparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.5.2" data-path="../binaryclass/webspam_scw.html">
            
                <a href="../binaryclass/webspam_scw.html">
            
                    
                        <b>5.5.2.</b>
                    
                    PA1, AROW, SCW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part VI - Multiclass classification</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../multiclass/news20.html">
            
                <a href="../multiclass/news20.html">
            
                    
                        <b>6.1.</b>
                    
                    News20 Multiclass Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1.1" data-path="../multiclass/news20_dataset.html">
            
                <a href="../multiclass/news20_dataset.html">
            
                    
                        <b>6.1.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.2" data-path="../multiclass/news20_one-vs-the-rest_dataset.html">
            
                <a href="../multiclass/news20_one-vs-the-rest_dataset.html">
            
                    
                        <b>6.1.2.</b>
                    
                    Data preparation for one-vs-the-rest classifiers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.3" data-path="../multiclass/news20_pa.html">
            
                <a href="../multiclass/news20_pa.html">
            
                    
                        <b>6.1.3.</b>
                    
                    PA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.4" data-path="../multiclass/news20_scw.html">
            
                <a href="../multiclass/news20_scw.html">
            
                    
                        <b>6.1.4.</b>
                    
                    CW, AROW, SCW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.5" data-path="../multiclass/news20_ensemble.html">
            
                <a href="../multiclass/news20_ensemble.html">
            
                    
                        <b>6.1.5.</b>
                    
                    Ensemble learning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.1.6" data-path="../multiclass/news20_one-vs-the-rest.html">
            
                <a href="../multiclass/news20_one-vs-the-rest.html">
            
                    
                        <b>6.1.6.</b>
                    
                    one-vs-the-rest classifier
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../multiclass/iris.html">
            
                <a href="../multiclass/iris.html">
            
                    
                        <b>6.2.</b>
                    
                    Iris Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.2.1" data-path="../multiclass/iris_dataset.html">
            
                <a href="../multiclass/iris_dataset.html">
            
                    
                        <b>6.2.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2.2" data-path="../multiclass/iris_scw.html">
            
                <a href="../multiclass/iris_scw.html">
            
                    
                        <b>6.2.2.</b>
                    
                    SCW
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2.3" data-path="../multiclass/iris_randomforest.html">
            
                <a href="../multiclass/iris_randomforest.html">
            
                    
                        <b>6.2.3.</b>
                    
                    RandomForest
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part VII - Regression</li>
        
        
    
        <li class="chapter " data-level="7.1" data-path="../regression/e2006.html">
            
                <a href="../regression/e2006.html">
            
                    
                        <b>7.1.</b>
                    
                    E2006-tfidf regression Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="../regression/e2006_dataset.html">
            
                <a href="../regression/e2006_dataset.html">
            
                    
                        <b>7.1.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="../regression/e2006_arow.html">
            
                <a href="../regression/e2006_arow.html">
            
                    
                        <b>7.1.2.</b>
                    
                    Passive Aggressive, AROW
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.2" data-path="../regression/kddcup12tr2.html">
            
                <a href="../regression/kddcup12tr2.html">
            
                    
                        <b>7.2.</b>
                    
                    KDDCup 2012 track 2 CTR prediction Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="../regression/kddcup12tr2_dataset.html">
            
                <a href="../regression/kddcup12tr2_dataset.html">
            
                    
                        <b>7.2.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="../regression/kddcup12tr2_lr.html">
            
                <a href="../regression/kddcup12tr2_lr.html">
            
                    
                        <b>7.2.2.</b>
                    
                    Logistic Regression, Passive Aggressive
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.3" data-path="../regression/kddcup12tr2_lr_amplify.html">
            
                <a href="../regression/kddcup12tr2_lr_amplify.html">
            
                    
                        <b>7.2.3.</b>
                    
                    Logistic Regression with Amplifier
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.4" data-path="../regression/kddcup12tr2_adagrad.html">
            
                <a href="../regression/kddcup12tr2_adagrad.html">
            
                    
                        <b>7.2.4.</b>
                    
                    AdaGrad, AdaDelta
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part VIII - Recommendation</li>
        
        
    
        <li class="chapter " data-level="8.1" data-path="cf.html">
            
                <a href="cf.html">
            
                    
                        <b>8.1.</b>
                    
                    Collaborative Filtering
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1.1" data-path="item_based_cf.html">
            
                <a href="item_based_cf.html">
            
                    
                        <b>8.1.1.</b>
                    
                    Item-based Collaborative Filtering
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="news20.html">
            
                <a href="news20.html">
            
                    
                        <b>8.2.</b>
                    
                    News20 related article recommendation Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.2.1" data-path="../multiclass/news20_dataset.html">
            
                <a href="../multiclass/news20_dataset.html">
            
                    
                        <b>8.2.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2.2" data-path="news20_jaccard.html">
            
                <a href="news20_jaccard.html">
            
                    
                        <b>8.2.2.</b>
                    
                    LSH/Minhash and Jaccard Similarity
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2.3" data-path="news20_knn.html">
            
                <a href="news20_knn.html">
            
                    
                        <b>8.2.3.</b>
                    
                    LSH/Minhash and Brute-Force Search
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.2.4" data-path="news20_bbit_minhash.html">
            
                <a href="news20_bbit_minhash.html">
            
                    
                        <b>8.2.4.</b>
                    
                    kNN search using b-Bits Minhash
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="movielens.html">
            
                <a href="movielens.html">
            
                    
                        <b>8.3.</b>
                    
                    MovieLens movie recommendation Tutorial
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="8.3.1" data-path="movielens_dataset.html">
            
                <a href="movielens_dataset.html">
            
                    
                        <b>8.3.1.</b>
                    
                    Data preparation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.2" data-path="movielens_mf.html">
            
                <a href="movielens_mf.html">
            
                    
                        <b>8.3.2.</b>
                    
                    Matrix Factorization
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.3" data-path="movielens_fm.html">
            
                <a href="movielens_fm.html">
            
                    
                        <b>8.3.3.</b>
                    
                    Factorization Machine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="8.3.4" data-path="movielens_cv.html">
            
                <a href="movielens_cv.html">
            
                    
                        <b>8.3.4.</b>
                    
                    10-fold Cross Validation (Matrix Factorization)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Part IX - Anomaly Detection</li>
        
        
    
        <li class="chapter " data-level="9.1" data-path="../anomaly/lof.html">
            
                <a href="../anomaly/lof.html">
            
                    
                        <b>9.1.</b>
                    
                    Outlier Detection using Local Outlier Factor (LOF)
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Part X - External References</li>
        
        
    
        <li class="chapter " data-level="10.1" >
            
                <a target="_blank" href="https://github.com/maropu/hivemall-spark">
            
                    
                        <b>10.1.</b>
                    
                    Hivemall on Apache Spark
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="10.2" >
            
                <a target="_blank" href="https://github.com/daijyc/hivemall/wiki/PigHome">
            
                    
                        <b>10.2.</b>
                    
                    Hivemall on Apache Pig
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Data preparation</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <!--
  Licensed to the Apache Software Foundation (ASF) under one
  or more contributor license agreements.  See the NOTICE file
  distributed with this work for additional information
  regarding copyright ownership.  The ASF licenses this file
  to you under the Apache License, Version 2.0 (the
  "License"); you may not use this file except in compliance
  with the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing,
  software distributed under the License is distributed on an
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, either express or implied.  See the License for the
  specific language governing permissions and limitations
  under the License.
-->
<h1 id="data-preparation">Data preparation</h1>
<p>First, downlod MovieLens dataset from the following site.</p>
<blockquote>
<p><a href="http://www.grouplens.org/system/files/ml-1m.zip" target="_blank">http://www.grouplens.org/system/files/ml-1m.zip</a></p>
</blockquote>
<p>Get detail about the dataset in the README.</p>
<blockquote>
<p><a href="http://files.grouplens.org/papers/ml-1m-README.txt" target="_blank">http://files.grouplens.org/papers/ml-1m-README.txt</a></p>
</blockquote>
<p>You can find three dat file in the archive: </p>
<blockquote>
<p>movies.dat, ratings.dat, users.dat.</p>
</blockquote>
<p>Change column separator as follows:</p>
<pre><code class="lang-sh">sed <span class="hljs-string">&apos;s/::/#/g&apos;</span> movies.dat &gt; movies.t
sed <span class="hljs-string">&apos;s/::/#/g&apos;</span> ratings.dat &gt; ratings.t
sed <span class="hljs-string">&apos;s/::/#/g&apos;</span> users.dat &gt; users.t
</code></pre>
<p>Create a file named occupations.t with the following contents:</p>
<pre><code>0#other/not specified
1#academic/educator
2#artist
3#clerical/admin
4#college/grad student
5#customer service
6#doctor/health care
7#executive/managerial
8#farmer
9#homemaker
10#K-12 student
11#lawyer
12#programmer
13#retired
14#sales/marketing
15#scientist
16#self-employed
17#technician/engineer
18#tradesman/craftsman
19#unemployed
20#writer
</code></pre><h1 id="importing-data-as-hive-tables">Importing data as Hive tables</h1>
<h2 id="create-tables">create tables</h2>
<pre><code class="lang-sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">database</span> movielens;
<span class="hljs-keyword">use</span> movielens;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTERNAL</span> <span class="hljs-keyword">TABLE</span> ratings (
  userid <span class="hljs-built_in">INT</span>, 
  movieid <span class="hljs-built_in">INT</span>,
  rating <span class="hljs-built_in">INT</span>, 
  tstamp <span class="hljs-keyword">STRING</span>
) <span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">DELIMITED</span>
<span class="hljs-keyword">FIELDS</span> <span class="hljs-keyword">TERMINATED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&apos;#&apos;</span>
<span class="hljs-keyword">STORED</span> <span class="hljs-keyword">AS</span> TEXTFILE
LOCATION <span class="hljs-string">&apos;/dataset/movielens/ratings&apos;</span>;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTERNAL</span> <span class="hljs-keyword">TABLE</span> movies (
  movieid <span class="hljs-built_in">INT</span>, 
  title <span class="hljs-keyword">STRING</span>,
  genres <span class="hljs-built_in">ARRAY</span>&lt;<span class="hljs-keyword">STRING</span>&gt;
) <span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">DELIMITED</span>
<span class="hljs-keyword">FIELDS</span> <span class="hljs-keyword">TERMINATED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&apos;#&apos;</span>
COLLECTION ITEMS <span class="hljs-keyword">TERMINATED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&quot;|&quot;</span>
<span class="hljs-keyword">STORED</span> <span class="hljs-keyword">AS</span> TEXTFILE
LOCATION <span class="hljs-string">&apos;/dataset/movielens/movies&apos;</span>;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTERNAL</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">users</span> (
  userid <span class="hljs-built_in">INT</span>, 
  gender <span class="hljs-keyword">STRING</span>, 
  age <span class="hljs-built_in">INT</span>,
  occupation <span class="hljs-built_in">INT</span>,
  zipcode <span class="hljs-keyword">STRING</span>
) <span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">DELIMITED</span>
<span class="hljs-keyword">FIELDS</span> <span class="hljs-keyword">TERMINATED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&apos;#&apos;</span>
<span class="hljs-keyword">STORED</span> <span class="hljs-keyword">AS</span> TEXTFILE
LOCATION <span class="hljs-string">&apos;/dataset/movielens/users&apos;</span>;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">EXTERNAL</span> <span class="hljs-keyword">TABLE</span> occupations (
  <span class="hljs-keyword">id</span> <span class="hljs-built_in">INT</span>,
  occupation <span class="hljs-keyword">STRING</span>
) <span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">DELIMITED</span>
<span class="hljs-keyword">FIELDS</span> <span class="hljs-keyword">TERMINATED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">&apos;#&apos;</span>
<span class="hljs-keyword">STORED</span> <span class="hljs-keyword">AS</span> TEXTFILE
LOCATION <span class="hljs-string">&apos;/dataset/movielens/occupations&apos;</span>;
</code></pre>
<h2 id="load-data-into-tables">load data into tables</h2>
<pre><code class="lang-sh">hadoop fs -put ratings.t /dataset/movielens/ratings
hadoop fs -put movies.t /dataset/movielens/movies
hadoop fs -put users.t /dataset/movielens/users
hadoop fs -put occupations.t /dataset/movielens/occupations
</code></pre>
<h1 id="create-a-concatenated-table">Create a concatenated table</h1>
<pre><code class="lang-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> rating_full
<span class="hljs-keyword">as</span>
<span class="hljs-keyword">select</span> 
  r.*, 
  m.title <span class="hljs-keyword">as</span> m_title,
  <span class="hljs-keyword">concat_ws</span>(<span class="hljs-string">&apos;|&apos;</span>,sort_array(m.genres)) <span class="hljs-keyword">as</span> m_genres, 
  u.gender <span class="hljs-keyword">as</span> u_gender,
  u.age <span class="hljs-keyword">as</span> u_age,
  u.occupation <span class="hljs-keyword">as</span> u_occupation,
  u.zipcode <span class="hljs-keyword">as</span> u_zipcode
<span class="hljs-keyword">from</span>
  ratings r 
  <span class="hljs-keyword">JOIN</span> movies m <span class="hljs-keyword">ON</span> (r.movieid = m.movieid)
  <span class="hljs-keyword">JOIN</span> <span class="hljs-keyword">users</span> u <span class="hljs-keyword">ON</span> (r.userid = u.userid);
</code></pre>
<p>hive&gt; desc rating_full;</p>
<pre><code>userid                  int                     None
movieid                 int                     None
rating                  int                     None
tstamp                  string                  None
m_title                 string                  None
m_genres                string                  None
u_gender                string                  None
u_age                   int                     None
u_occupation            int                     None
u_zipcode               string                  None
</code></pre><hr>
<h1 id="creating-trainingtesting-data">Creating training/testing data</h1>
<p>Create a training/testing table such that each has 80%/20% of the original rating data.</p>
<pre><code class="lang-sql"><span class="hljs-comment">-- Adding rowids to the rating table</span>
<span class="hljs-keyword">SET</span> hivevar:<span class="hljs-keyword">seed</span>=<span class="hljs-number">31</span>;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> ratings2
<span class="hljs-keyword">as</span>
<span class="hljs-keyword">select</span>
  <span class="hljs-keyword">rand</span>(${<span class="hljs-keyword">seed</span>}) <span class="hljs-keyword">as</span> rnd, 
  userid, 
  movieid, 
  rating
<span class="hljs-keyword">from</span> 
  ratings;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> training
<span class="hljs-keyword">as</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> ratings2
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> rnd <span class="hljs-keyword">DESC</span>
<span class="hljs-keyword">limit</span> <span class="hljs-number">800000</span>;

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> testing
<span class="hljs-keyword">as</span>
<span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> ratings2
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> rnd <span class="hljs-keyword">ASC</span>
<span class="hljs-keyword">limit</span> <span class="hljs-number">200209</span>;
</code></pre>
<p><div id="page-footer"><hr><p><sub><font color="gray">
Apache Hivemall is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator.
</font></sub></p>
</div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Data preparation","level":"8.3.1","depth":2,"next":{"title":"Matrix Factorization","level":"8.3.2","depth":2,"path":"recommend/movielens_mf.md","ref":"recommend/movielens_mf.md","articles":[]},"previous":{"title":"MovieLens movie recommendation Tutorial","level":"8.3","depth":1,"path":"recommend/movielens.md","ref":"recommend/movielens.md","articles":[{"title":"Data preparation","level":"8.3.1","depth":2,"path":"recommend/movielens_dataset.md","ref":"recommend/movielens_dataset.md","articles":[]},{"title":"Matrix Factorization","level":"8.3.2","depth":2,"path":"recommend/movielens_mf.md","ref":"recommend/movielens_mf.md","articles":[]},{"title":"Factorization Machine","level":"8.3.3","depth":2,"path":"recommend/movielens_fm.md","ref":"recommend/movielens_fm.md","articles":[]},{"title":"10-fold Cross Validation (Matrix Factorization)","level":"8.3.4","depth":2,"path":"recommend/movielens_cv.md","ref":"recommend/movielens_cv.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["theme-api","edit-link","github","splitter","sitemap","etoc","callouts","toggle-chapters","anchorjs","codeblock-filename","expandable-chapters","multipart","codeblock-filename","katex","emphasize","localized-footer"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"emphasize":{},"callouts":{},"etoc":{"maxdepth":3,"mindepth":1,"notoc":true},"github":{"url":"https://github.com/apache/incubator-hivemall/"},"splitter":{},"search":{},"downloadpdf":{"base":"https://github.com/apache/incubator-hivemall/docs/gitbook","label":"PDF","multilingual":false},"multipart":{},"localized-footer":{"filename":"FOOTER.md"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2,"font":"sans"},"highlight":{},"codeblock-filename":{},"sitemap":{"hostname":"http://hivemall.incubator.apache.org/"},"theme-api":{"languages":[],"split":false,"theme":"dark"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":"Edit","base":"https://github.com/apache/incubator-hivemall/docs/gitbook"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"anchorjs":{"selector":"h1,h2,h3,*:not(.callout) > h4,h5"},"toggle-chapters":{},"expandable-chapters":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Hivemall User Manual","links":{"sidebar":{"<i class=\"fa fa-home\"></i> Home":"http://hivemall.incubator.apache.org/"}},"gitbook":"3.x.x","description":"User Manual for Apache Hivemall"},"file":{"path":"recommend/movielens_dataset.md","mtime":"2016-11-12T07:18:00.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-11-14T10:40:22.987Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-splitter/splitter.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-etoc/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/3.1.1/anchor.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    

    </body>
</html>

